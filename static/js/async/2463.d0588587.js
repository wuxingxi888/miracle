"use strict";(self.webpackChunk=self.webpackChunk||[]).push([["2463"],{7580:function(s,a,n){n.r(a),n.d(a,{default:function(){return t}});var p=n(1147);let l=["innerHTML"],t={setup:()=>({html:""}),render:()=>((0,p.wg)(),(0,p.iD)("div",{class:"mi-doc-markdown-body",innerHTML:'<h1>进阶用法</h1>\n<div class="mi-doc-card"><h3 id="jie-shao" tabindex="-1">介绍</h3>\n<p>通过本章节你可以了解到 Miracle 的一些进阶用法，比如组件插槽用法、多种浏览器适配方式。</p>\n</div><h2 id="zu-jian-yong-fa" tabindex="-1">组件用法</h2>\n<div class="mi-doc-card"><h3 id="zu-jian-zhu-ce" tabindex="-1">组件注册</h3>\n<p>Miracle 支持多种组件注册方式，请根据实际业务需要进行选择。</p>\n<h4 id="quan-ju-zhu-ce" tabindex="-1">全局注册</h4>\n<p>全局注册后，你可以在 app 下的任意子组件中使用注册的 Miracle 组件。</p>\n<pre><code class="language-js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@miracle-web/ui&#x27;</span>;\n<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;\n\n<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>();\n\n<span class="hljs-comment">// 方式一. 通过 app.use 注册</span>\n<span class="hljs-comment">// 注册完成后，在模板中通过 &lt;mi-button&gt; 或 &lt;MiButton&gt; 标签来使用按钮组件</span>\napp.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Button</span>);\n\n<span class="hljs-comment">// 方式二. 通过 app.component 注册</span>\n<span class="hljs-comment">// 注册完成后，在模板中通过 &lt;mi-button&gt; 标签来使用按钮组件</span>\napp.<span class="hljs-title function_">component</span>(<span class="hljs-title class_">Button</span>.<span class="hljs-property">name</span>, <span class="hljs-title class_">Button</span>);\n</code></pre>\n<h4 id="quan-liang-zhu-ce" tabindex="-1">全量注册</h4>\n<p>你也可以在全局一次性注册所有 Miracle 组件：</p>\n<pre><code class="language-js"><span class="hljs-keyword">import</span> <span class="hljs-title class_">Miracle</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@miracle-web/ui&#x27;</span>;\n<span class="hljs-keyword">import</span> { createApp } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;vue&#x27;</span>;\n\n<span class="hljs-keyword">const</span> app = <span class="hljs-title function_">createApp</span>();\n\napp.<span class="hljs-title function_">use</span>(<span class="hljs-title class_">Miracle</span>);\n\n<span class="hljs-comment">// Lazyload 指令需要单独进行注册</span>\napp.<span class="hljs-title function_">use</span>(miracle.<span class="hljs-property">Lazyload</span>);\n</code></pre>\n<blockquote>\n<p>注意：注册所有组件会引入所有组件的代码，导致包体积增大。</p>\n</blockquote>\n<h4 id="ju-bu-zhu-ce" tabindex="-1">局部注册</h4>\n<p>局部注册后，你可以在当前组件中使用注册的 Miracle 组件。</p>\n<pre><code class="language-js"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@miracle-web/ui&#x27;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n    <span class="hljs-attr">components</span>: {\n        [<span class="hljs-title class_">Button</span>.<span class="hljs-property">name</span>]: <span class="hljs-title class_">Button</span>,\n    },\n};\n</code></pre>\n<blockquote>\n<p>对于组件注册更详细的介绍，请参考 <a href="https://cn.vuejs.org/guide/components/registration.html" target="_blank">Vue 官方文档 - 组件注册</a>。</p>\n</blockquote>\n<h4 id="script-setup" tabindex="-1">&lt;script setup&gt;</h4>\n<p>在 <code>&lt;script setup&gt;</code> 中可以直接使用 Miracle 组件，不需要进行组件注册。</p>\n<pre><code class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">setup</span>&gt;</span><span class="language-javascript">\n  <span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@miracle-web/ui&#x27;</span>;\n</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>\n\n<span class="hljs-tag">&lt;<span class="hljs-name">template</span>&gt;</span>\n  <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> /&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>\n</code></pre>\n<h4 id="jsx-tsx" tabindex="-1">JSX/TSX</h4>\n<p>在 JSX 和 TSX 中可以直接使用 Miracle 组件，不需要进行组件注册。</p>\n<pre><code class="language-jsx"><span class="hljs-keyword">import</span> { <span class="hljs-title class_">Button</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;@miracle-web/ui&#x27;</span>;\n\n<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n    <span class="hljs-title function_">render</span>(<span class="hljs-params"></span>) {\n        <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Button</span> /&gt;</span></span>;\n    },\n};\n</code></pre>\n</div><div class="mi-doc-card"><h3 id="zu-jian-cha-cao" tabindex="-1">组件插槽</h3>\n<p>Miracle 提供了丰富的组件插槽，通过插槽可以对组件的某一部分进行个性化定制。如果你对 Vue 的插槽不太熟悉，可以阅读 Vue 官方文档中的<a href="https://cn.vuejs.org/guide/components/slots.html" target="_blank">插槽章节</a>。下面是通过插槽来定制 Checkbox 图标的示例：</p>\n<pre><code class="language-html"><span class="hljs-tag">&lt;<span class="hljs-name">mi-checkbox</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;checked&quot;</span>&gt;</span>\n    <span class="hljs-comment">&lt;!-- 使用组件提供的 icon 插槽 --&gt;</span>\n    <span class="hljs-comment">&lt;!-- 将默认图标替换为个性化图片 --&gt;</span>\n    <span class="hljs-tag">&lt;<span class="hljs-name">template</span> #<span class="hljs-attr">icon</span>=<span class="hljs-string">&quot;props&quot;</span>&gt;</span>\n        <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">:src</span>=<span class="hljs-string">&quot;props.checked ? activeIcon : inactiveIcon&quot;</span> /&gt;</span>\n    <span class="hljs-tag">&lt;/<span class="hljs-name">template</span>&gt;</span>\n<span class="hljs-tag">&lt;/<span class="hljs-name">mi-checkbox</span>&gt;</span>\n</code></pre>\n<pre><code class="language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) {\n        <span class="hljs-keyword">return</span> {\n            <span class="hljs-attr">checked</span>: <span class="hljs-literal">true</span>,\n            <span class="hljs-attr">activeIcon</span>: <span class="hljs-string">&#x27;https://xxx-active.png&#x27;</span>,\n            <span class="hljs-attr">inactiveIcon</span>: <span class="hljs-string">&#x27;https://xxx-inactive.png&#x27;</span>,\n        };\n    },\n};\n</code></pre>\n</div><div class="mi-doc-card"><h3 id="zu-jian-shi-li-fang-fa" tabindex="-1">组件实例方法</h3>\n<p>Miracle 中的许多组件提供了实例方法，调用实例方法时，我们需要通过 <a href="https://cn.vuejs.org/guide/essentials/template-refs.html" target="_blank">ref</a> 来注册组件引用信息，引用信息将会注册在父组件的<code>$refs</code>对象上。注册完成后，我们可以通过<code>this.$refs.xxx</code>访问到对应的组件实例，并调用上面的实例方法。</p>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 通过 ref 属性将组件绑定到 this.$refs.checkbox 上 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">mi-checkbox</span> <span class="hljs-attr">v-model</span>=<span class="hljs-string">&quot;checked&quot;</span> <span class="hljs-attr">ref</span>=<span class="hljs-string">&quot;checkbox&quot;</span>&gt;</span>复选框<span class="hljs-tag">&lt;/<span class="hljs-name">mi-checkbox</span>&gt;</span>\n</code></pre>\n<pre><code class="language-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {\n    <span class="hljs-title function_">data</span>(<span class="hljs-params"></span>) {\n        <span class="hljs-keyword">return</span> {\n            <span class="hljs-attr">checked</span>: <span class="hljs-literal">false</span>,\n        };\n    },\n    <span class="hljs-comment">// 注意：组件挂载后才能访问到 ref 对象</span>\n    <span class="hljs-title function_">mounted</span>(<span class="hljs-params"></span>) {\n        <span class="hljs-variable language_">this</span>.<span class="hljs-property">$refs</span>.<span class="hljs-property">checkbox</span>.<span class="hljs-title function_">toggle</span>();\n    },\n};\n</code></pre>\n</div><h2 id="liu-lan-qi-gua-pei" tabindex="-1">浏览器适配</h2>\n<div class="mi-doc-card"><h3 id="viewport-bu-ju" tabindex="-1">Viewport 布局</h3>\n<p>Miracle 默认使用 <code>px</code> 作为样式单位，如果需要使用 <code>viewport</code> 单位 (vw, vh, vmin, vmax)，推荐使用 <a href="https://github.com/evrone/postcss-px-to-viewport" target="_blank">postcss-px-to-viewport</a> 进行转换。</p>\n<p><a href="https://github.com/evrone/postcss-px-to-viewport" target="_blank">postcss-px-to-viewport</a> 是一款 PostCSS 插件，用于将 px 单位转化为 vw/vh 单位。</p>\n<h4 id="postcss-postcss-shi-li-pei-zhi" tabindex="-1">PostCSS PostCSS 示例配置</h4>\n<p>下面提供了一份基本的 PostCSS 示例配置，可以在此配置的基础上根据项目需求进行修改。</p>\n<pre><code class="language-js"><span class="hljs-comment">// postcss.config.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n    <span class="hljs-attr">plugins</span>: {\n        <span class="hljs-string">&#x27;postcss-px-to-viewport&#x27;</span>: {\n            <span class="hljs-attr">viewportWidth</span>: <span class="hljs-number">375</span>,\n        },\n    },\n};\n</code></pre>\n<blockquote>\n<p>Tips: 在配置 postcss-loader 时，应避免 ignore node_modules 目录，否则将导致 Miracle 样式无法被编译。</p>\n</blockquote>\n</div><div class="mi-doc-card"><h3 id="rem-bu-ju-gua-pei" tabindex="-1">Rem 布局适配</h3>\n<p>如果需要使用 <code>rem</code> 单位进行适配，推荐使用以下两个工具：</p>\n<ul>\n<li><a href="https://github.com/cuth/postcss-pxtorem" target="_blank">postcss-pxtorem</a> 是一款 PostCSS 插件，用于将 px 单位转化为 rem 单位</li>\n<li><a href="https://github.com/amfe/lib-flexible" target="_blank">lib-flexible</a> 用于设置 rem 基准值</li>\n</ul>\n<h4 id="postcss-shi-li-pei-zhi" tabindex="-1">PostCSS 示例配置</h4>\n<p>下面提供了一份基本的 PostCSS 示例配置，可以在此配置的基础上根据项目需求进行修改。</p>\n<pre><code class="language-js"><span class="hljs-comment">// postcss.config.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n    <span class="hljs-attr">plugins</span>: {\n        <span class="hljs-string">&#x27;postcss-pxtorem&#x27;</span>: {\n            <span class="hljs-attr">rootValue</span>: <span class="hljs-number">37.5</span>,\n            <span class="hljs-attr">propList</span>: [<span class="hljs-string">&#x27;*&#x27;</span>],\n        },\n    },\n};\n</code></pre>\n<blockquote>\n<p>Tips: 在配置 postcss-pxtorem 时，同样应避免 ignore node_modules 目录，否则会导致 Miracle 样式无法被编译。</p>\n</blockquote>\n<h4 id="qi-ta-she-ji-gao-chi-cun" tabindex="-1">其他设计稿尺寸</h4>\n<p>如果设计稿的尺寸不是 375，而是 750 或其他大小，可以将 <code>rootValue</code> 配置调整为:</p>\n<pre><code class="language-js"><span class="hljs-comment">// postcss.config.js</span>\n<span class="hljs-variable language_">module</span>.<span class="hljs-property">exports</span> = {\n    <span class="hljs-attr">plugins</span>: {\n        <span class="hljs-comment">// postcss-pxtorem 插件的版本需要 &gt;= 5.0.0</span>\n        <span class="hljs-string">&#x27;postcss-pxtorem&#x27;</span>: {\n            <span class="hljs-title function_">rootValue</span>(<span class="hljs-params">{ file }</span>) {\n                <span class="hljs-keyword">return</span> file.<span class="hljs-title function_">indexOf</span>(<span class="hljs-string">&#x27;Miracle&#x27;</span>) !== -<span class="hljs-number">1</span> ? <span class="hljs-number">37.5</span> : <span class="hljs-number">75</span>;\n            },\n            <span class="hljs-attr">propList</span>: [<span class="hljs-string">&#x27;*&#x27;</span>],\n        },\n    },\n};\n</code></pre>\n</div><div class="mi-doc-card"><h3 id="zhuo-mian-duan-gua-pei" tabindex="-1">桌面端适配</h3>\n<p>Miracle 是一个面向移动端的组件库，因此默认只适配了移动端设备，这意味着组件只监听了移动端的 <code>touch</code> 事件，没有监听桌面端的 <code>mouse</code> 事件。</p>\n<p>如果你需要在桌面端使用 Miracle，可以引入我们提供的 <a href="https://github.com/wuxingxi888/miracle/tree/main/packages/miracle-touch-emulator" target="_blank">@miracle-web/touch-emulator</a>，这个库会在桌面端自动将 <code>mouse</code> 事件转换成对应的 <code>touch</code> 事件，使得组件能够在桌面端使用。</p>\n<pre><code class="language-bash"><span class="hljs-comment"># 安装模块</span>\nnpm i @miracle-web/touch-emulator -S\n</code></pre>\n<pre><code class="language-js"><span class="hljs-comment">// 引入模块后自动生效</span>\n<span class="hljs-keyword">import</span> <span class="hljs-string">&#x27;@miracle-web/touch-emulator&#x27;</span>;\n</code></pre>\n</div><div class="mi-doc-card"><h3 id="di-bu-an-quan-qu-gua-pei" tabindex="-1">底部安全区适配</h3>\n<p>iPhone X 等机型底部存在底部指示条，指示条的操作区域与页面底部存在重合，容易导致用户误操作，因此我们需要针对这些机型进行安全区适配。Miracle 中部分组件提供了 <code>safe-area-inset-top</code> 或 <code>safe-area-inset-bottom</code> 属性，设置该属性后，即可在对应的机型上开启适配，如下示例：</p>\n<pre><code class="language-html"><span class="hljs-comment">&lt;!-- 在 head 标签中添加 meta 标签，并设置 viewport-fit=cover 值 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">meta</span>\n    <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span>\n    <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, viewport-fit=cover&quot;</span>\n/&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 开启顶部安全区适配 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">mi-nav-bar</span> <span class="hljs-attr">safe-area-inset-top</span> /&gt;</span>\n\n<span class="hljs-comment">&lt;!-- 开启底部安全区适配 --&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">mi-number-keyboard</span> <span class="hljs-attr">safe-area-inset-bottom</span> /&gt;</span>\n</code></pre>\n</div>'},null,8,l))}}}]);